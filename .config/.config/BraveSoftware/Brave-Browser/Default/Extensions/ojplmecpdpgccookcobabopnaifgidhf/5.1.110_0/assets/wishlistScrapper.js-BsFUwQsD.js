import{c as y}from"./utility_all2-BNXd1yEL.js";import"./index-ljv-RBOm.js";let u="",w=0;async function d(){}function b(){let a=window.location.href;return a.includes("/wishlist")||a.includes("/mywishlist")||a.includes("/iwish")||a.includes("dispatch=wishlist.view")||a.includes("/myfavourites")||a.includes("/Wishlist")||a.includes("/favorites")?1:0}function P(a){try{if(g(a)=="")return"";let s=u.nameSelector;for(let o=0;o<s.length;o++)try{let n=a,t=a,e="",l="",r=s[o];for(let i=0;i<r.selector.length;i++)n=n.querySelector(r.selector[i]);if(r.hasOwnProperty("attribute"))e=n[r.attribute];else{let i=n.textContent;i==null||i==""||r.selector.length==0?e=n:e=i}if(r.hasOwnProperty("slice")){let i=r.slice[0];r.slice.length>1?end=r.slice[1]:end=e.length,e=e.slice(i,end)}if(r.hasOwnProperty("path")&&(e=p(e,r.path)),r.hasOwnProperty("brandselector")){for(let i=0;i<r.brandselector.length&&t!=null;i++)t=t.querySelector(r.brandselector[i]);t!=null&&r.hasOwnProperty("brandattribute")?l=t[r.brandattribute]:t!=null&&(l=t.textContent),l!=""&&l!=null&&(e=l.trim()+" "+e.trim())}if(r.hasOwnProperty("regex"))for(let i=0;i<r.regex.length;i++)try{let c=1;r.hasOwnProperty("match")&&(c=r.match);let h;if(r.hasOwnProperty("global")?h=e.match(new RegExp(r.regex[i],"g"))[c]:h=e.match(new RegExp(r.regex[i]))[c],h!=null&&h!=""){e=h;break}}catch{}if(e!=""&&e!=null){if(u.hasOwnProperty("skuSelector1")){let i=m(document,u);e=e+" "+i}return e.trim()}if(e!=""&&e!=null)return e=e.replaceAll("&amp;","&"),e=e.replaceAll(`
`,""),e=e.replaceAll("â¯",""),e.trim()}catch{}return""}catch{return""}}function x(a){try{if(g(a)=="")return"";let s=u.imgSelector;for(let o=0;o<s.length;o++)try{let n=a,t="",e=s[o];for(let l=0;l<e.selector.length;l++)n=n.querySelector(e.selector[l]);if(e.hasOwnProperty("attribute")?t=n[e.attribute]:t=n.textContent,e.hasOwnProperty("path")&&(t=p(t,e.path)),e.hasOwnProperty("regex"))for(let l=0;l<e.regex.length;l++)try{let r=1;e.hasOwnProperty("match")&&(r=e.match);let i;if(e.hasOwnProperty("global")?i=t.match(new RegExp(e.regex[l],"g"))[r]:i=t.match(new RegExp(e.regex[l]))[r],i!=null&&i!=""){t=i;break}}catch{}if(e.hasOwnProperty("replace")&&e.hasOwnProperty("replace_with"))for(let l=0;l<e.replace.length;l++)t=t.replace(e.replace[l],e.replace_with);if(t!=""&&t!=null)return t.trim()}catch{}return""}catch{return""}}function O(a){try{if(g(a)=="")return 0;let s=u.priceSelector;for(let o=0;o<s.length;o++)try{let n=a,t=null,e=s[o];for(let r=0;r<e.selector.length;r++)n=n.querySelector(e.selector[r]);e.hasOwnProperty("attribute")?t=n[e.attribute]:t=n.textContent,e.hasOwnProperty("path")&&(t=p(t,e.path));let l=0;if(e.hasOwnProperty("currency")){for(let r=0;r<e.currency.length;r++)if(t.includes(e.currency[r])){l=1;break}if(l==0)return-1}if(e.hasOwnProperty("sub_reg")&&(t=t.match(e.sub_reg)[0]),e.hasOwnProperty("regex"))for(let r=0;r<e.regex.length;r++)try{let i;if(e.hasOwnProperty("global")?i=t.match(new RegExp(e.regex[r],"g")).join(""):i=t.match(new RegExp(e.regex[r])).join(""),i=parseFloat(i),i!=null&&i!=""){t=i;break}}catch{}if(t=parseFloat(t),t!=""&&t!=null&&!isNaN(t))return t}catch{}return 0}catch{return 0}}function g(a){try{let s=u.pidSelector;for(let o=0;o<s.length;o++)try{let n=a,t="",e=s[o];for(let c=0;c<e.selector.length;c++)n=n.querySelector(e.selector[c]);if(e.hasOwnProperty("attribute"))t=n[e.attribute],(t==null||t==null)&&(t=n.getAttribute(e.attribute));else{let c=n.textContent;c==null||c==""||e.selector.length==0?t=n:t=c}e.hasOwnProperty("path")&&(t=p(t,e.path));let l=t,r=0,i=0;if(e.hasOwnProperty("navKey")){if(!t.includes("navKey"))return"";t.includes("/sv/")&&(r=1),t.includes("/pk/")&&(i=1)}if(e.hasOwnProperty("regex"))for(let c=0;c<e.regex.length;c++)try{let h=1;e.hasOwnProperty("match")&&(h=e.match);let f;if(e.hasOwnProperty("global")?f=t.match(new RegExp(e.regex[c],"g"))[h]:f=t.match(new RegExp(e.regex[c]))[h],f!=null&&f!=""){t=f;break}}catch{}if(r&&(t=t+"~sv"),i&&(t=t+"~pk"),t!=""&&t!=null){if(u.hasOwnProperty("skuSelector1")){let c=m(document,u);c!=""&&(t=t+"~"+c)}if(e.hasOwnProperty("navKey")){let c=l.match(e.navKey);c&&c[1]?t=c[1]+"~"+t:t="~"+t}return t.trim()}}catch{}return""}catch{return""}}function S(a){try{let s=u.urlSelector;for(let o=0;o<s.length;o++)try{let n=a,t="",e=s[o];for(let l=0;l<e.selector.length;l++)n=n.querySelector(e.selector[l]);if(e.hasOwnProperty("attribute"))t=n[e.attribute];else{let l=n.textContent;l==null||l==""||e.selector.length==0?t=n:t=l}if(e.hasOwnProperty("path")&&(t=p(t,e.path)),t!=""&&t!=null)return t.trim()}catch{}return""}catch{return""}}function p(a,s){try{const o=s.split(".");let n=a;for(const t of o)if(t.includes("[")&&t.includes("]")){const e=t.substring(0,t.indexOf("[")),l=parseInt(t.match(/\d+/)[0],10);if(Array.isArray(n[e]))n=n[e][l];else throw new Error(`Invalid path: ${s}`)}else n=n[t];return n}catch{return null}}function m(a,s){try{let o=s.skuSelector1;for(let n=0;n<o.length;n++)try{let t=a,e="",l=o[n];for(let r=0;r<l.selector.length;r++)t=t.querySelector(l.selector[r]);if(l.hasOwnProperty("attribute"))e=t[l.attribute];else{let r=t.textContent;r==null||r==""?e=t:e=r}if(l.hasOwnProperty("regex"))for(let r=0;r<l.regex.length;r++)try{let i=1;l.hasOwnProperty("match")&&(i=l.match);let c;if(l.hasOwnProperty("global")?c=e.match(new RegExp(l.regex[r],"g"))[i]:c=e.match(new RegExp(l.regex[r]))[i],c!=null&&c!=""){e=c;break}}catch{}if(e!=""&&e!=null)return e.trim()}catch{}return""}catch{return""}}function j(a){return/^[~\/a-zA-Z0-9-: _.]+$/.test(a)}async function k(){curData=[];try{let a=u.classSelector;a=document.querySelectorAll(a);for(let s=0;s<a.length;s++){let o=a[s],n=P(o),t=x(o),e=O(o),l=g(o),r=S(o);if(l!=""&&(e>0||e==-1)&&j(l)){e==-1&&(e=0);let i={prod:n,image:t,price:e,url:r,pid:l,pos:sitePOS};curData.push(i)}}return await y({type:"sendWishlistData",data:curData}),w=1,curData}catch{}}async function v(){try{if(pos=await getPOS(),pos==""||pos==null||pos==null)throw new Error("Cannot get pos");if(sitePOS=pos,u=await y({type:"getScrapConfigWishlist",pos}),u==null||u==null||u=="")throw new Error("Cannot get config");await d();let a=document.querySelector(".hk-main-wishlistAlert");a.onclick=async()=>{w==0&&(document.querySelector(".hk-main-wishlistAlert").classList.add("hk-sTab__pw--on"),await k())}}catch{}}window.addEventListener("pageshow",async()=>{b()==1&&v()});
